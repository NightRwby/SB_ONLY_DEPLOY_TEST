<th:block th:fragment="popupFragment"> <div class="modal_screen">
    <div class="blackscreen">
        <form action="/community/free/write" method="post" enctype="multipart/form-data" class="modal_popup">

            <div class="modal_header">
                <div class="modal_title">
                    <h2>게시글 작성</h2>
                </div>
                <div class="modal_btn">
                    <div class="mbtn_L">
                        <button type="button" class="btn_modal_close" id="modal_exit">닫기</button>
                    </div>
                    <div class="mbtn_R">
                        <button type="submit" id="modal_accept">저장</button>
                    </div>
                </div>
            </div>

            <div class="modal_section">
                <div class="modal_form">
                    <div class="write_title">
                        <label for="modal_input" class="modal_form_label">제목</label>
                        <input type="text" id="modal_input" name="title" placeholder="제목을 입력하세요." required />
                    </div>
                    <div class="selec_cart">
                        <label for="modal_select" class="modal_form_label">카테고리</label>
                        <select id="modal_select" name="category">
                            <option value="일상" th:selected="${category == '일상'}">일상</option>
                            <option value="질문" th:selected="${category == '질문'}">질문</option>
                            <option value="정보" th:selected="${category == '정보'}">정보</option>
                            <option value="후기" th:selected="${category == '후기'}">후기</option>
                            <option value="리뷰" th:selected="${category == '리뷰'}">리뷰</option>
                            <option value="유머" th:selected="${category == '유머'}">유머</option>
                            <option value="밈" th:selected="${category == '밈'}">밈</option>
                            <option value="공지" th:selected="${category == '공지'}">공지</option>
                        </select>
                    </div>
                </div>

                <div class="modal_file">
                    <div class="upload_wrap">
                        <div class="upload_row">
                            <label class="modal_form_label" for="wImages">이미지 업로드</label>
                            <input id="wImages" name="files" type="file" accept="image/*" multiple />
                        </div>
                    </div>
                    <button type="button" id="clearImages">전체 삭제</button>
                </div>

                <div class="modal_file_preview" id="modal_file_preview"></div>

                <div class="modal_text">
                    <label class="modal_form_label" for="modal_textarea">본문</label>
                    <textarea id="modal_textarea" name="content" placeholder="내용을 작성하세요." required></textarea>
                    <div class="modal_form_meta" id="charCount">0자</div>
                </div>
            </div>
        </form>
    </div>
</div>


    <div class="modal_detail_screen">
        <div class="blackscreen">
            <div class="modal_detail_popup">
                <div class="modal_detail_header">
                    <div class="modal_detail_topheader">
                        <div class="modal_detail_title">
                            <h2 id="detailTitle">게시글 제목 로딩중...</h2>
                        </div>
                        <div class="modal_detail_btn">
                            <div class="mdbtn_L">
                                <button type="button" class="btn_modal_close" id="modal_detail_exit">닫기</button>
                            </div>
                        </div>
                    </div>
                    <div class="modal_detail_info">
                        <div class="info_text">
                            <div class="detail_creater" id="detailWriter">작성자</div>
                            <div class="detail_date" id="detailDate">날짜</div>
                            <div class="detail_cart" id="detailCategory">카테고리</div>
                            <div class="detail_udbtn_wrap">
                                <button type="button" id="detail_update">수정</button>
                                <button type="button" id="detail_delete">삭제</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal_detail_section">
                    <div class="modal_detail_images" id="detailImages"></div>
                    <div class="modal_detail_text" id="detailContent">내용 로딩중...</div>
                </div>
                <div class="like">
                    <span id="detailLikes">현재 추천 수 : 0</span>
                    <span id="detailViews">현재 조회 수 : 0</span>
                    <button type="button" class="likebtn">추천하기 !</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal_update_screen">
        <div class="blackscreen">
            <form action="/community/free/update" method="post" enctype="multipart/form-data" class="modal_popup">
                <input type="hidden" id="update_id" name="id" value="">

<!--                기존 이미지 제거를 위한 히든 인풋-->
                <input type="hidden"
                       id="clearExistingFlag"
                       name="clearExistingFiles"
                       value="false">

                <div class="modal_header">
                    <div class="modal_title">
                        <h2>게시글 수정하기</h2>
                    </div>
                    <div class="modal_btn">
                        <div class="mbtn_L">
                            <button type="button" class="btn_modal_close" id="update_modal_exit">닫기</button>
                        </div>
                        <div class="mbtn_R">
                            <button type="submit" id="update_modal_accept">저장</button>
                        </div>
                    </div>
                </div>

                <div class="modal_section">
                    <div class="modal_form">
                        <div class="write_title">
                            <label for="update_modal_input" class="modal_form_label">제목</label>
                            <input type="text" id="update_modal_input" name="title" placeholder="제목을 입력하세요." required />
                        </div>
                        <div class="selec_cart">
                            <label for="update_modal_select" class="modal_form_label">카테고리</label>
                            <select id="update_modal_select" name="category">
                                <option value="일상" th:selected="${category == '일상'}">일상</option>
                                <option value="질문" th:selected="${category == '질문'}">질문</option>
                                <option value="정보" th:selected="${category == '정보'}">정보</option>
                                <option value="후기" th:selected="${category == '후기'}">후기</option>
                                <option value="리뷰" th:selected="${category == '리뷰'}">리뷰</option>
                                <option value="유머" th:selected="${category == '유머'}">유머</option>
                                <option value="밈" th:selected="${category == '밈'}">밈</option>
                                <option value="공지" th:selected="${category == '공지'}">공지</option>
                            </select>
                        </div>
                    </div>

                    <div class="modal_file">
                        <div class="upload_wrap">
                            <div class="upload_row">
                                <label class="modal_form_label" for="update_wImages">이미지 업로드</label>
                                <input id="update_wImages" name="files" type="file" accept="image/*" multiple />
                            </div>
                        </div>
                        <button type="button" id="update_clearImages">전체 삭제</button>
                    </div>
                    <div class="modal_file_preview" id="update_modal_file_preview"></div>
                    <div class="modal_text">
                        <label class="modal_form_label" for="update_modal_textarea">본문</label>
                        <textarea id="update_modal_textarea" name="content" placeholder="내용을 작성하세요." required></textarea>
                    </div>
                </div>
            </form>
        </div>
    </div>

</th:block>